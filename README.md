# 序列帧特效预览器

这是一个用于预览序列帧特效的GUI应用程序，支持多种目录加载方式。

## 功能特点

- 自动扫描指定文件夹下的所有特效文件夹（支持多层目录）
- 树形分类显示，根据文件夹结构自动分组
- 可调节扫描深度（1-5层）
- 支持选择任意目录作为特效根目录
- 支持拖拽文件夹到程序中加载（完整版）
- 实时筛选功能，快速查找特效
- 点击特效名称即可加载和预览
- 选择后自动播放（可选）
- 自动播放下一个特效（可选）
- 反序播放支持（适用于反序特效文件）
- 支持播放/暂停/停止控制
- 可调节播放速度
- 显示当前帧信息和序列帧文件列表
- 点击序列帧文件可预览单张图片
- 异步加载避免界面假死
- 自动调整图片大小适应预览窗口
- 一键打开特效文件所在目录
- 智能自然排序（正确处理数字序列）

## 安装依赖

```bash
pip install -r requirements.txt
```

## 运行方式

### 方式1：完整版本（支持拖拽）
```bash
python effect_preview.py
```

### 方式2：简化版本（不需要tkinterdnd2）
```bash
python effect_preview_simple.py
```

### 方式3：使用批处理文件（Windows）
- **智能启动**：双击 `run_preview.bat` 文件，会自动检测环境并让你选择版本
- **简化版**：双击 `run_simple.bat` 文件，直接启动简化版
- **完整版**：双击 `run_full.bat` 文件，直接启动完整版（自动安装拖拽依赖）

## 使用说明

### 目录加载
1. **选择目录**：点击"选择目录"按钮选择包含特效文件夹的目录
2. **拖拽加载**：直接将文件夹拖拽到程序窗口中（仅完整版本支持）
3. **重置目录**：点击"重置"按钮清空当前目录选择

### 特效预览
1. 左侧会显示当前目录下所有可用的特效，按文件夹结构分类
2. 📁 图标表示分类文件夹，🎬 图标表示特效文件
3. 使用筛选框可以快速查找特定特效
4. 点击特效名称来加载该特效（点击分类文件夹无效）
5. 默认会自动播放动画（可通过复选框控制）
6. 中间区域显示当前特效的所有序列帧文件
7. 点击序列帧文件名可以预览单张图片
8. 使用播放控制按钮来控制动画播放
9. 勾选"反序播放"可以反向播放特效
10. 勾选"自动播放下一个"可以连续播放多个特效
11. 拖动速度滑块来调整播放速度
12. 调整"扫描深度"来控制搜索子目录的层数（1-5层）
13. 点击"打开文件目录"按钮在文件管理器中查看特效文件
14. 异步加载机制避免大量文件时界面假死

## 支持的图片格式

- PNG
- JPG/JPEG
- GIF

## 文件夹结构

程序会自动扫描以下结构（支持多层嵌套）：
```
任意目录/
├── 分类1/
│   ├── 特效A/
│   │   ├── frame_01.png
│   │   ├── frame_02.png
│   │   └── ...
│   └── 特效B/
│       ├── image_01.png
│       ├── image_02.png
│       └── ...
├── 分类2/
│   └── 子分类/
│       └── 特效C/
│           ├── seq_001.png
│           ├── seq_002.png
│           └── ...
└── 根目录特效/
    ├── effect_01.png
    ├── effect_02.png
    └── ...
```

**扫描规则：**
- 自动识别包含图片文件的文件夹作为特效
- 根据文件夹层级自动分类
- 支持1-5层深度扫描
- 使用自然排序确保正确的播放顺序

## 版本说明

- **effect_preview.py**：完整版本，支持拖拽功能，需要安装tkinterdnd2
- **effect_preview_simple.py**：简化版本，不支持拖拽，但依赖更少